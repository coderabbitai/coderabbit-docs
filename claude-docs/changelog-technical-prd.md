# Technical PRD: Branded Changelog Section in Docusaurus

## Objective

Build a visually distinct, standalone changelog section in Docusaurus with branded visuals, structured entries, and a timeline-style sidebar ‚Äî while preserving SEO, routing, and backward compatibility.

## Scope Overview

| Area                     | Implementation                                 |
| ------------------------ | ---------------------------------------------- |
| Markdown-based changelog | One file per release (`/changelog/*.md`)       |
| Custom index page        | `/changelog/index.md` with hero image and copy |
| Per-entry hero image     | Declared in frontmatter, optimized             |
| Sidebar                  | Custom layout mimicking Vercel's timeline      |
| Right-hand ToC           | Hidden on all changelog pages                  |
| Redirects                | From legacy anchors (`/docs/changelog#...`)    |

## Features & Requirements

### 1. üìÇ Content Structure

Each changelog entry is a `.md` file in `/changelog`

**Required frontmatter:**

```yaml
---
title: "New API Endpoints"
date: "2025-07-20"
tags: ["feature", "api"]
heroImage: "/img/changelog/hero-api.png" # Web-optimized
---
```

- Optional `_category_.json` used for ordering or grouping
- Naming convention: `YYYY-MM-DD-slug.md` for stable URLs

### 2. üß© Docusaurus Plugin Configuration

**docusaurus.config.js**

```js
plugins: [
  [
    '@docusaurus/plugin-content-docs',
    {
      id: 'changelog',
      path: 'changelog',
      routeBasePath: 'changelog',
      sidebarPath: require.resolve('./sidebarsChangelog.js'),
      showLastUpdateTime: true,
    },
  ],
  [
    '@docusaurus/plugin-client-redirects',
    {
      redirects: [
        { from: '/docs/changelog#2025-07-20', to: '/changelog/2025-07-20-slug' },
        // add others as needed
      ],
    },
  ]
],
```

### 3. üìú Custom Index Page

**File:** `changelog/index.md` (or `index.mdx`)

**Contents:**

- Custom hero section with marketing copy and a GIF or animation
- List of latest changelog entries
- Use React components if needed

**Example:**

```mdx
import ChangelogList from "@site/src/components/ChangelogList"
import styles from "./index.module.css"

# What's New at Acme

Here's where we announce product improvements, features, and fixes. You can also [subscribe via RSS](/rss).

<img
	src="/img/changelog/intro-graphic.gif"
	alt="Changelog GIF"
	className={styles.heroGif}
/>

<ChangelogList limit={5} />
```

### 4. üñº Individual Changelog Hero Image

- Render hero image from `frontmatter.heroImage`
- Show as banner at the top of the page
- Web optimized (e.g. compressed `.webp` or `.avif`)
- Loaded via `<img loading="lazy" />`

**Implementation:** Swizzle `@theme/DocItem` and customize rendering:

```tsx
{
	frontMatter.heroImage && (
		<img src={frontMatter.heroImage} alt="" className={styles.hero} />
	)
}
```

### 5. üß≠ Sidebar as Timeline

**Goal:** Make left sidebar feel like a timeline ‚Äî like Vercel's.

**Approach:**

- Use the sidebar plugin with autogenerated structure
- Swizzle `@theme/DocSidebar` for `id: changelog` to apply custom layout:
  - Vertical timeline styling with dots, icons, or dates
  - Suppress doc nesting
  - CSS to override default Docusaurus sidebar look
  - Small dot or pill icon before each release
  - Year dividers optional

**Example CSS idea:**

```css
.sidebar-item {
	border-left: 2px solid #eee;
	padding-left: 1rem;
	position: relative;
}
.sidebar-item::before {
	content: "";
	position: absolute;
	left: -7px;
	top: 0.6rem;
	height: 10px;
	width: 10px;
	background-color: var(--ifm-color-primary);
	border-radius: 50%;
}
```

### 6. ‚ùå Remove Right-Hand ToC

Globally disable the ToC for changelog content via frontmatter:

```yaml
hide_table_of_contents: true
```

Or, apply in layout logic via plugin customization for all content under `id: changelog`.

## ‚úçüèΩ Migration & Redirects

**From:** `/docs/changelog.md` with anchors (e.g. `#2025-07-20`)  
**To:** `/changelog/yyyy-mm-dd-slug`

**Steps:**

1. Parse `changelog.md` ‚Üí extract anchor IDs
2. Map to new file slugs
3. Generate redirect rules in `@plugin-client-redirects`
4. Optionally: automate this via script (`scripts/migrate-changelog.js`)

## üß™ QA Checklist

- [ ] All old anchor links redirect cleanly to the new pages
- [ ] `/changelog` loads with hero, copy, GIF
- [ ] Each changelog entry displays hero image and content properly
- [ ] Sidebar renders as a timeline and reflects all entries
- [ ] Right-hand ToC is absent on all changelog pages
- [ ] Content is indexable/searchable
